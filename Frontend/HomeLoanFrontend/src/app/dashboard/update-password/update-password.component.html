<mat-dialog-actions class="py-1">
  <button mat-icon-button mat-dialog-close style="margin-left: auto">
    <mat-icon>close</mat-icon>
  </button>
</mat-dialog-actions>
<mat-card
  class="w-100 d-flex text-center justify-content-center align-items-center"
  style="max-width: 500px"
>
  <form [formGroup]="changePasswordForm" (ngSubmit)="submitForm()" novalidate>
    <mat-card-header class="justify-content-center mb-2 pt-1">
      <mat-card-title>Change Password</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div class="form-group">
        <mat-form-field appearance="outline">
          <mat-label>Old Password</mat-label>
          <input matInput [type]="hideOld ? 'password' : 'text'" formControlName="oldPassword" />
          <button mat-icon-button matSuffix (click)="hideOld = !hideOld" [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hideOld" type="button">
            <mat-icon>{{hideOld ? 'visibility_off' : 'visibility'}}</mat-icon>
          </button>
          <mat-error
            *ngIf="changePasswordForm.get('oldPassword')?.hasError('required')"
            >Old Password is required</mat-error
          >
        </mat-form-field>
      </div>
      <div class="form-group">
        <mat-form-field appearance="outline">
          <mat-label>New Password</mat-label>
          <input
            matInput
            [type]="hideNew ? 'password' : 'text'"
            formControlName="newPassword"
            required
          />
          <button mat-icon-button matSuffix (click)="hideNew = !hideNew" [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hideNew" type="button">
            <mat-icon>{{hideNew ? 'visibility_off' : 'visibility'}}</mat-icon>
          </button>
          <mat-error
            *ngIf="changePasswordForm.get('newPassword')?.hasError('required')"
            >Password is required</mat-error
          >
          <mat-error
            *ngIf="
              changePasswordForm.get('newPassword')?.hasError('minlength') ||
              changePasswordForm.get('newPassword')?.hasError('pattern')
            "
            >Password format is invalid</mat-error
          >
        </mat-form-field>
      </div>
      <div class="form-group">
        <mat-form-field appearance="outline">
          <mat-label>Confirm New Password</mat-label>
          <input matInput [type]="hideConfirmNew ? 'password' : 'text'" formControlName="confirmPassword" />
          <button mat-icon-button matSuffix (click)="hideConfirmNew = !hideConfirmNew" [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hideConfirmNew" type="button">
            <mat-icon>{{hideConfirmNew ? 'visibility_off' : 'visibility'}}</mat-icon>
          </button>
          <mat-error
            *ngIf="
              changePasswordForm.get('confirmPassword')?.hasError('required')
            "
            >Password is required</mat-error
          >
          <mat-error
            *ngIf="
              changePasswordForm.get('confirmPassword')?.hasError('compareWith')
            "
            >Passwords do not match</mat-error
          >
        </mat-form-field>
      </div>
    </mat-card-content>
    <mat-card-actions class="justify-content-center">
      <button
        type="submit"
        mat-raised-button
        color="primary"
        class="small-button"
      >
        Change Password
      </button>
    </mat-card-actions>
    <mat-card-footer>
      <mat-progress-bar
        mode="indeterminate"
        *ngIf="showProgressBar"
      ></mat-progress-bar>
    </mat-card-footer>
  </form>
</mat-card>
